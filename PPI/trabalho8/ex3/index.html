<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">

    <title>exercicio3</title>
    <style>
    

    main {
      width: 25%;
      height: 20%;
      background-color: #eee;
      border: 0.5px solid gray;
      padding: 2% 2%;
      margin: 0 auto;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      
    }



    </style>
</head>
<body>
   <main>
       <div class="container" >

           <form>
               <div class="col-12" >
                   <label for="especialidade">Especialidade:</label> <br>
                   <select name="especialidade" id="especialidade" class="form-select" onchange="opcoes(this)">
                       <option>Especialidade</option>
                       <option value="cardio">Cardiologia</option>
                       <option value="dermato">Dermatologia</option>
                       <option value="oftalmo">Oftalmologia</option>
                   </select>
               </div>
               <div class="col-12" >
                   <label for="medico">MÃ©dico:</label> <br>
                   <select name="medico" id="medico" class="form-select" disabled>
                   </select>
               </div>
   
           </form>
       </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-popRpmFF9JQgExhfw5tZT4I9/CI5e2QcuUZPOVXb1m7qUmeR2b50u+YFEYe1wgzy"
    crossorigin="anonymous"></script>

    <script>

        async function opcoes(e){
            const esp = e.value;
            let select = document.getElementById("medico");

            
            try{
                const response = await fetch("medicos.php?esp=" + esp);
                
                if (!response.ok) {
                    throw new Error(response.status);
                }

                var resp = await response.json();
            }
            catch (e) {
                console.error(e);
                return;
            }
            
            select.removeAttribute('disabled')
            select.innerHTML = '';
            for (i in resp) {
                let option = document.createElement("option");
                option.text = resp[i].nome_medico + ' - ' + resp[i].telefone_medico;
                option.value = resp[i].nome_medico + ' - ' + resp[i].nome_medico;
                select.add(option);
            }

        }
    </script>
</body>
</html>